#include<iostream>
using namespace std;
//class ob
//{
//public:
//	void func()
//	{
//		cout << "void func()" << endl;
//	}
//};
//typedef void(ob::* pobfunc)();
//void 表示该成员函数无返回值。
//ob::* 开始定义一个指向类 ob 的成员函数的指针。
//pobfunc 是新定义的类型名称，你可以使用这个名称来代替这个复杂的成员函数指针类型。
//所以，pobfunc 类型代表了类 ob 中无返回值的成员函数的指针。通过这种类型的指针，你可以调用类 ob 的实例的相应成员函数。
//int main1()
//{
//	pobfunc p = &ob::func;
//	ob tmp;
//	(tmp.*p  )();
//
//	int i, j;
//
//	cout << (i = j = 10) << endl;
//	return 0;
//}
//class Date
//{
//public:
//private:
//	int _year;
//	int _month;
//	int _day;
//};
class A
{
public: 
	A(int a)
		:_a(a)
	{
		cout << "a" << endl;
	}
	A* operator&()
	{
		return this;
	}
	const A* operator&() const
	{
		return this;
	}
private:
	int _a;
};

class Date
{
public:
	Date(int year, int month, int day, int& x)
		:_ref(x)//初始化列表，不能在当前列表多次初始化
		,_aa(10)
		,_p((int*)malloc(10))
{
	_year = year;
	_month = month;
	_day = day;
	_ref = x;
	//_n = 5;//_n不可修改
}

	Date(int year, int month, int day,int x)
	: _month(2)
	, _n(10)
	,_aa(10)
	,_ref(x)
{
	_year = year;
	_month = month;
	_day = day;
}
	 
//初始化列表是每个成员变量定义初始化的位置
//可使用初始化列表 或 函数体内赋值
//建议使用初始化列表

private:
	int _year=1;
	int _month;
	int _day;
	int* _p;

	//必须初始化，初始化共两处(此处缺省或初始化列表)
	const int _n=5;
	int& _ref;//引用必须初始化
	A _aa;
};


//成员变量在类中的声明次序就是初始化列表中的初始化顺序，与其在初始化列表的先后次序无关。
class B
{
public:
	B(int a1,int a2)
		:_a1(a1)
		,_a2(a2)
	{}
private:
	int _a1;
	int _a2;
	int _a = 1;
	int* _p = (int*)malloc(4);
	A aa1 = 1;
};

int main10()
{
	B aa2 = { 1,2 };//隐式强制类型转换
	return 0;
}
int n = 0;
class D
{
public:
	D()
	{
		n++;
	}

	D(const D& aa)
	{
		n++;
	}
};
D func()
{
	D aa;
	return aa;
}
int main11()
{
	D aa1;
	D aa2;
	func();//此处被优化，原4次，先3次
	cout << n << endl;
	return 0;
}
//关于 .* 的使用
//相当于.(*p)  ,
//p必须指向类C的成员，而*p则是对指针p解引用，解引用后必须为类C的成员
struct C
{
	int m;

	void f()
	{
		int C::* x1 = &C::m; // pointer to member m of C
		int* x2 = &(C::m); // pointer to member this->m
	}
};
int main()
{
	int C::* p = &C::m; // p 是类指向类 C 成员 m 的指针， 
	// 固定格式 T U::*  
	// T 是它指向的成员的类型，U 是它指向的类的类型
	// 这里就是 int C::* ：指向类 C 的 int 成员
	C c = { 7 };
	std::cout << c.*p << '\n';   // 访问 p 所指向的字段
	C* cp = &c;
	cp->m = 10;
	std::cout << cp->*p << '\n'; // 访问 p 所指向的字段
}






